
package esxi

import (
	"testing"
)

func TestCompactIp(t *testing.T) {
	cases := []struct {
		input []string
		want  string
	}{
		{
			input: []string{},
			want:  "",
		},
		{
			input: []string{"192.168.200.2"},
			want:  "192.168.200.2",
		},
		{
			input: []string{"192.168.200.2", "192.168.200.3"},
			want:  "192.168.200.2,3",
		},
		{
			input: []string{"192.168.200.2", "192.168.200.3", "192.168.200.3"},
			want:  "192.168.200.2,3",
		},
		{
			input: []string{"192.168.200.2", "192.168.200.3", "192.168.200.3", "192.168.200.4"},
			want:  "192.168.200.2-4",
		},
		{
			input: []string{"192.168.200.2", "192.168.200.3", "192.168.200.3", "192.168.200.4", "192.168.200.5"},
			want:  "192.168.200.2-5",
		},
		{
			input: []string{"192.168.200.2", "192.168.200.3", "192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.7"},
			want:  "192.168.200.2-5,7",
		},
		{
			input: []string{"192.168.200.1", "192.168.200.3", "192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.7"},
			want:  "192.168.200.1,3-5,7",
		},
		{
			input: []string{"192.168.200.1", "192.168.200.3", "192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.7", "10.127.40.3"},
			want:  "10.127.40.3;192.168.200.1,3-5,7",
		},
		{
			input: []string{"192.168.200.1", "192.168.200.3", "192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.7", "10.127.40.3", "10.127.40.4"},
			want:  "10.127.40.3,4;192.168.200.1,3-5,7",
		},
		{
			input: []string{"192.168.200.1", "192.168.200.3", "192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.7", "10.127.40.3", "10.127.40.4", "10.127.40.5"},
			want:  "10.127.40.3-5;192.168.200.1,3-5,7",
		},
		{
			input: []string{"192.168.200.1", "192.168.200.3", "192.168.200.3", "192.168.200.4", "192.168.200.5", "192.168.200.7", "10.127.40.3", "10.127.40.4", "10.127.40.5", "192.168.201.1"},
			want:  "10.127.40.3-5;192.168.200.1,3-5,7;192.168.201.1",
		},
		{
			input: []string{"10.127.40.40", "10.127.40.43", "10.127.40.5", "10.127.40.35", "10.127.40.41"},
			want:  "10.127.40.5,35,40,41,43",
		},
	}
	for _, c := range cases {
		got := compactIPs(c.input)
		if got != c.want {
			t.Errorf("want: %s got: %s", c.want, got)
		}
	}
}
